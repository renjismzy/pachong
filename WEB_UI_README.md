# 比赛信息爬虫Web管理界面

## 功能特性

### 🎯 核心功能
- **可视化管理**: 直观的Web界面管理所有爬虫任务
- **实时监控**: 实时显示任务状态、系统资源使用情况
- **手动触发**: 支持单独或批量执行爬虫任务
- **定时调度**: 灵活的定时任务管理，支持Cron表达式
- **日志查看**: 在线查看和管理日志文件
- **状态同步**: 使用WebSocket实现实时状态更新

### 📊 监控面板
- CPU、内存、磁盘使用率实时监控
- 运行中任务数量统计
- 各平台爬虫状态显示
- 任务执行历史记录

## 安装和启动

### 1. 安装依赖
```bash
pip install -r requirements.txt
```

### 2. 启动Web应用

**方法一：使用批处理文件（Windows）**
```bash
start_web.bat
```

**方法二：直接运行Python文件**
```bash
python web_app.py
```

### 3. 访问界面
启动成功后，在浏览器中访问：
```
http://localhost:5000
```

## 使用指南

### 🚀 快速操作

#### 手动执行爬虫
1. 在主界面找到对应的爬虫平台卡片
2. 点击「运行」按钮执行单个爬虫
3. 或点击「运行所有爬虫」按钮执行全部爬虫

#### 查看任务状态
- **空闲**: 灰色标签，任务未运行
- **运行中**: 蓝色标签，任务正在执行
- **已完成**: 绿色标签，任务执行成功
- **错误**: 红色标签，任务执行失败

### ⏰ 定时任务管理

#### 添加定时任务
1. 点击「添加定时任务」按钮
2. 填写任务信息：
   - **任务ID**: 唯一标识符
   - **爬虫平台**: 选择要执行的爬虫
   - **Cron表达式**: 定时规则
3. 点击「添加」完成创建

#### Cron表达式示例
```
# 格式: 分 时 日 月 周
0 9 * * *     # 每天上午9点
0 */6 * * *   # 每6小时执行一次
0 9 * * 1     # 每周一上午9点
0 9 1 * *     # 每月1号上午9点
*/30 * * * *   # 每30分钟执行一次
```

#### 管理定时任务
- 在定时任务卡片中查看所有已创建的任务
- 点击垃圾桶图标删除不需要的任务

### 📋 日志管理

#### 查看日志
1. 点击「查看日志」按钮
2. 在下拉菜单中选择日志文件
3. 查看日志内容（显示最后1000行）

#### 日志文件说明
- `scheduler_YYYYMM.log`: 定时任务调度日志
- `task_scheduler.log`: 任务调度器日志

### 🔧 系统监控

#### 资源监控
- **CPU使用率**: 实时显示系统CPU占用
- **内存使用率**: 实时显示内存占用情况
- **磁盘使用率**: 显示磁盘空间使用情况
- **运行任务**: 当前正在执行的任务数量

## 技术架构

### 后端技术栈
- **Flask**: Web框架
- **Flask-SocketIO**: WebSocket支持
- **APScheduler**: 定时任务调度
- **psutil**: 系统资源监控

### 前端技术栈
- **Bootstrap 5**: UI框架
- **Socket.IO**: 实时通信
- **Bootstrap Icons**: 图标库

### 核心组件
- **web_app.py**: Web应用主文件
- **templates/index.html**: 前端页面模板
- **static/**: 静态资源目录（自动创建）

## API接口

### 任务管理
- `GET /api/status`: 获取所有任务状态
- `POST /api/run/<platform>`: 执行指定平台爬虫
- `POST /api/run/all`: 执行所有爬虫任务

### 定时任务
- `POST /api/schedule`: 添加定时任务
- `DELETE /api/schedule/<job_id>`: 删除定时任务

### 日志管理
- `GET /api/logs`: 获取日志文件列表
- `GET /api/logs/<filename>`: 获取日志文件内容

## 注意事项

### 🔒 安全建议
- 建议在内网环境中使用
- 生产环境请修改默认的SECRET_KEY
- 考虑添加用户认证机制

### ⚡ 性能优化
- 大型日志文件只显示最后1000行
- 使用WebSocket减少轮询请求
- 后台线程执行爬虫任务，避免阻塞界面

### 🐛 故障排除

#### 常见问题
1. **端口占用**: 如果5000端口被占用，修改web_app.py中的端口号
2. **模块导入失败**: 确保所有爬虫模块文件存在且可导入
3. **权限问题**: 确保有读写logs目录的权限

#### 日志调试
- 查看控制台输出获取详细错误信息
- 检查logs目录中的日志文件
- 使用浏览器开发者工具查看网络请求

## 扩展功能

### 可选增强
- 用户认证和权限管理
- 任务执行历史统计
- 邮件/微信通知
- 数据可视化图表
- 配置文件在线编辑

---

**享受使用比赛信息爬虫Web管理界面！** 🎉